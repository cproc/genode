#
# \brief  Makefile for building QMake for Genode
# \author Christian Prochaska
# \author Norman Feske
# \date   2013-03-27
#
# This file is based on the generated Makefile created by qt5's configure.
#

########################################################################
## This file was autogenerated by configure, all changes will be lost ##
########################################################################
CC = gcc
CXX = g++
QMAKE_CFLAGS = -pipe
QMAKE_CXXFLAGS = -pipe
QMAKE_LFLAGS =

# Genode repository
REP_DIR := ../../..

include $(REP_DIR)/lib/mk/qt5_version.inc

# root of Qt5 source tree
CONTRIB_DIR := $(REP_DIR)/contrib/$(QT5)/qtbase

# tell make where to look for source codes
vpath %.h   $(CONTRIB_DIR)/qmake
vpath %.cpp $(CONTRIB_DIR)/qmake
vpath %.cpp $(CONTRIB_DIR)/qmake/generators
vpath %.cpp $(CONTRIB_DIR)/qmake/generators/mac
vpath %.cpp $(CONTRIB_DIR)/qmake/generators/unix
vpath %.cpp $(CONTRIB_DIR)/qmake/generators/win32
vpath %.cpp $(CONTRIB_DIR)/qmake/generators/symbian
vpath %.cpp $(CONTRIB_DIR)/qmake/generators/integrity
vpath %.cpp $(CONTRIB_DIR)/qmake/library
vpath %.cpp $(CONTRIB_DIR)/src/corelib/codecs
vpath %.cpp $(CONTRIB_DIR)/src/corelib/tools
vpath %.cpp $(CONTRIB_DIR)/src/corelib/global
vpath %.cpp $(CONTRIB_DIR)/src/corelib/kernel
vpath %.cpp $(CONTRIB_DIR)/src/corelib/plugin
vpath %.cpp $(CONTRIB_DIR)/src/corelib/io
vpath %.cpp $(CONTRIB_DIR)/src/corelib/xml
vpath %.cpp $(CONTRIB_DIR)/tools/shared/symbian
vpath %.cpp $(CONTRIB_DIR)/tools/shared/windows

QCONFIG_CPP_PATH = ../../../../src/lib/qt5/qtbase/src/corelib/global
SOURCE_PATH = $(CONTRIB_DIR)
BUILD_PATH = .
QTOBJS = 
QTSRCS = 
QMAKESPEC = $(SOURCE_PATH)/mkspecs/linux-g++
LFLAGS = $(QMAKE_LFLAGS)

QMKSRC = $(SOURCE_PATH)/qmake
QMKLIBSRC = $(QMKSRC)/library
QMKGENSRC = $(QMKSRC)/generators

#qmake code
OBJS=project.o option.o property.o main.o ioutils.o proitems.o \
     qmakeglobals.o qmakeparser.o qmakeevaluator.o qmakebuiltins.o \
     makefile.o unixmake2.o unixmake.o  \
     mingw_make.o winmakefile.o projectgenerator.o \
     meta.o makefiledeps.o metamakefile.o xmloutput.o pbuilder_pbx.o \
     msvc_vcproj.o msvc_vcxproj.o msvc_nmake.o msvc_objectmodel.o msbuild_objectmodel.o \
     gbuild.o cesdkhandler.o

#qt code
QOBJS=qtextcodec.o qutfcodec.o qstring.o qstringbuilder.o qtextstream.o qiodevice.o qmalloc.o qglobal.o \
      qarraydata.o qbytearray.o qbytearraymatcher.o qdatastream.o qbuffer.o qlist.o qfiledevice.o qfile.o \
      qfilesystementry.o qfilesystemengine_unix.o qfilesystemengine.o qfilesystemiterator_unix.o \
      qfsfileengine_unix.o qfsfileengine.o \
      qfsfileengine_iterator.o qregexp.o qvector.o qbitarray.o qdir.o qdiriterator.o quuid.o qhash.o \
      qfileinfo.o qdatetime.o qstringlist.o qabstractfileengine.o qtemporaryfile.o \
      qmap.o qmetatype.o qsettings.o qsystemerror.o qlibraryinfo.o qvariant.o qvsnprintf.o \
      qlocale.o qlocale_tools.o qlocale_unix.o qlinkedlist.o qnumeric.o qcryptographichash.o \
      qxmlstream.o qxmlutils.o qlogging.o \
      $(QTOBJS)




#all sources, used for the depend target
DEPEND_SRC = \
	   $(QMKSRC)/main.cpp $(QMKSRC)/project.cpp $(QMKSRC)/option.cpp $(QMKSRC)/property.cpp \
	   $(QMKSRC)/meta.cpp \
	   $(QMKLIBSRC)/ioutils.cpp $(QMKLIBSRC)/proitems.cpp $(QMKLIBSRC)/qmakeglobals.cpp \
	   $(QMKLIBSRC)/qmakeparser.cpp $(QMKLIBSRC)/qmakeevaluator.cpp $(QMKLIBSRC)/qmakebuiltins.cpp \
	   $(QMKGENSRC)/makefiledeps.cpp $(QMKGENSRC)/metamakefile.cpp \
	   $(QMKGENSRC)/projectgenerator.cpp $(QMKGENSRC)/makefile.cpp \
	   $(QMKGENSRC)/unix/unixmake.cpp $(QMKGENSRC)/unix/unixmake2.cpp \
	   $(QMKGENSRC)/mac/pbuilder_pbx.cpp $(QMKGENSRC)/integrity/gbuild.cpp \
	   $(QMKGENSRC)/win32/winmakefile.cpp \
	   $(QMKGENSRC)/win32/mingw_make.cpp $(QMKGENSRC)/win32/msvc_nmake.cpp \
	   $(QMKGENSRC)/win32/cesdkhandler.cpp $(QMKGENSRC)/mac/xmloutput.cpp  \
	   $(QMKGENSRC)/win32/msvc_vcproj.cpp $(QMKGENSRC)/win32/msvc_vcxproj.cpp \
	   $(QMKGENSRC)/win32/msvc_objectmodel.cpp $(QMKGENSRC)/win32/msbuild_objectmodel.cpp \
	   $(SOURCE_PATH)/src/corelib/codecs/qtextcodec.cpp $(SOURCE_PATH)/src/corelib/codecs/qutfcodec.cpp \
	   $(SOURCE_PATH)/src/corelib/tools/qstring.cpp $(SOURCE_PATH)/src/corelib/io/qfile.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qfiledevice.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qtextstream.cpp $(SOURCE_PATH)/src/corelib/io/qiodevice.cpp \
	   $(SOURCE_PATH)/src/corelib/global/qmalloc.cpp \
	   $(SOURCE_PATH)/src/corelib/global/qglobal.cpp $(SOURCE_PATH)/src/corelib/tools/qregexp.cpp \
	   $(SOURCE_PATH)/src/corelib/tools/qarraydata.cpp $(SOURCE_PATH)/src/corelib/tools/qbytearray.cpp\
	   $(SOURCE_PATH)/src/corelib/tools/qbytearraymatcher.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qdatastream.cpp $(SOURCE_PATH)/src/corelib/io/qbuffer.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qfilesystementry.cpp $(SOURCE_PATH)/src/corelib/io/qfilesystemengine_unix.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qfilesystemengine_mac.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qfilesystemengine.cpp $(SOURCE_PATH)/src/corelib/io/qfilesystemiterator_unix.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qfsfileengine_unix.cpp $(SOURCE_PATH)/src/corelib/io/qabstractfileengine.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qfsfileengine_iterator.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qfsfileengine.cpp $(SOURCE_PATH)/src/corelib/tools/qlist.cpp \
	   $(SOURCE_PATH)/src/corelib/tools/qvector.cpp $(SOURCE_PATH)/src/corelib/tools/qbitarray.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qdiriterator.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qdir.cpp $(SOURCE_PATH)/src/corelib/plugin/quuid.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qfileinfo.cpp $(SOURCE_PATH)/src/corelib/tools/qdatetime.cpp \
	   $(SOURCE_PATH)/src/corelib/tools/qstringlist.cpp $(SOURCE_PATH)/src/corelib/tools/qmap.cpp \
	   $(SOURCE_PATH)/src/corelib/global/qconfig.cpp \
	   $(SOURCE_PATH)/src/corelib/tools/qstringbuilder.cpp \
	   $(SOURCE_PATH)/src/corelib/tools/qlocale.cpp \
	   $(SOURCE_PATH)/src/corelib/tools/qlocale_tools.cpp \
	   $(SOURCE_PATH)/src/corelib/tools/qlocale_unix.cpp \
	   $(SOURCE_PATH)/src/corelib/tools/qlinkedlist.cpp \
	   $(SOURCE_PATH)/src/corelib/tools/qhash.cpp $(SOURCE_PATH)/src/corelib/kernel/qcore_mac.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qtemporaryfile.cpp $(SOURCE_PATH)/src/corelib/kernel/qmetatype.cpp \
	   $(SOURCE_PATH)/src/corelib/io/qsettings.cpp $(SOURCE_PATH)/src/corelib/kernel/qvariant.cpp \
	   $(SOURCE_PATH)/src/corelib/global/qlibraryinfo.cpp $(SOURCE_PATH)/src/corelib/tools/qcryptographichash.cpp \
	   $(SOURCE_PATH)/src/corelib/tools/qvsnprintf.cpp $(SOURCE_PATH)/src/corelib/global/qnumeric.cpp \
	   $(SOURCE_PATH)/src/corelib/xml/qxmlstream.cpp \
	   $(SOURCE_PATH)/src/corelib/xml/qxmlutils.cpp \
	   $(SOURCE_PATH)/src/corelib/kernel/qsystemerror.cpp \
	   $(SOURCE_PATH)/src/corelib/global/qlogging.cpp \
	   $(QTSRCS)

CPPFLAGS = -g $(OPENSOURCE_CXXFLAGS) \
	   -I$(QMKSRC) -I$(QMKLIBSRC) -I$(QMKSRC)/generators -I$(QMKSRC)/generators/unix -I$(QMKSRC)/generators/win32 \
	   -I$(QMKSRC)/generators/mac -I$(QMKSRC)/generators/integrity \
	   -I$(BUILD_PATH)/include -I$(BUILD_PATH)/include/QtCore \
	   -I$(BUILD_PATH)/include/QtCore/$(QT_VERSION) -I$(BUILD_PATH)/include/QtCore/$(QT_VERSION)/QtCore \
	   -I$(BUILD_PATH)/src/corelib/global -DHAVE_QCONFIG_CPP \
	   -I$(QMAKESPEC) \
	   -I$(SOURCE_PATH)/tools/shared \
	   -DQT_BUILD_QMAKE -DQT_BOOTSTRAPPED -DPROEVALUATOR_FULL -DPROEVALUATOR_DEBUG \
	   -DQT_NO_TEXTCODEC -DQT_NO_UNICODETABLES -DQT_NO_COMPONENT -DQT_NO_COMPRESS \
	   -DQT_NO_THREAD -DQT_NO_QOBJECT -DQT_NO_GEOM_VARIANT -DQT_NO_DATASTREAM

# extensions of the CPPFLAGS needed for the out-of-tree build
CPPFLAGS += -I$(CONTRIB_DIR)/qmake
CPPFLAGS += $(addprefix -I$(CONTRIB_DIR)/qmake/, generators generators/symbian generators/unix generators/win32 generators/mac generators/integrity)
CPPFLAGS += -I$(REP_DIR)/src/lib/qt5/qtbase/src/corelib/global
CPPFLAGS += -I$(REP_DIR)/include/qt5 -I$(REP_DIR)/include/qt5/qtbase/QtCore
CPPFLAGS += -I$(CONTRIB_DIR)/include -I$(CONTRIB_DIR)/include/QtCore
CPPFLAGS += -I$(CONTRIB_DIR)/include/QtCore/$(QT_VERSION) -I$(CONTRIB_DIR)/include/QtCore/$(QT_VERSION)/QtCore
CPPFLAGS += -I$(QCONFIG_CPP_PATH)

# enable automatic dependency generation
CPPFLAGS += -MMD

CXXFLAGS = $(QMAKE_CXXFLAGS) -DQMAKE_OPENSOURCE_EDITION $(CPPFLAGS)

first all: qmake

qmake: $(OBJS) $(QOBJS)
	$(CXX) -o "$@" $(OBJS) $(QOBJS) $(LFLAGS)

clean::
	rm -f qmake $(OBJS) $(QOBJS) $(OBJS:.o=.d) $(QOBJS:.o=.d)

distclean:: clean

-include *.d

# DO NOT DELETE THIS LINE -- make depend depends on it
