qtwebkit_configuration.patch

From: Christian Prochaska <christian.prochaska@genode-labs.com>


---
 .gitmodules                                        |    5 ++++-
 .../Tools/qmake/mkspecs/features/configure.prf     |    1 -
 qtwebkit/Tools/qmake/mkspecs/features/features.prf |   22 ++++++++++----------
 qtwebkit/Tools/qmake/mkspecs/features/features.pri |    2 +-
 4 files changed, 16 insertions(+), 14 deletions(-)

diff --git a/.gitmodules b/.gitmodules
index f64970a99d..f6dd69860a 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -308,4 +308,7 @@
 	path = qtremoteobjects
 	url = ../qtremoteobjects.git
 	branch = 5.9.8
-	status = preview
\ No newline at end of file
+	status = preview
+[submodule "qtwebkit"]
+	path = qtwebkit
+	project = WebKit.pro
diff --git a/qtwebkit/Tools/qmake/mkspecs/features/configure.prf b/qtwebkit/Tools/qmake/mkspecs/features/configure.prf
index 23d99040b6..6ea194fc1f 100644
--- a/qtwebkit/Tools/qmake/mkspecs/features/configure.prf
+++ b/qtwebkit/Tools/qmake/mkspecs/features/configure.prf
@@ -49,7 +49,6 @@ defineTest(runConfigure) {
 
     WEBKIT_CONFIG += \
         build_webkit1 \
-        build_webkit2 \
         build_tests \
         $$WEBKIT_TOOLS_CONFIG
 
diff --git a/qtwebkit/Tools/qmake/mkspecs/features/features.prf b/qtwebkit/Tools/qmake/mkspecs/features/features.prf
index 328a8be7e7..096d8ef679 100644
--- a/qtwebkit/Tools/qmake/mkspecs/features/features.prf
+++ b/qtwebkit/Tools/qmake/mkspecs/features/features.prf
@@ -37,14 +37,14 @@ defineTest(detectFeatures) {
     qtHaveModule(printsupport): WEBKIT_CONFIG += have_qtprintsupport
     qtHaveModule(widgets): WEBKIT_CONFIG += have_qstyle
     qtHaveModule(testlib): WEBKIT_CONFIG += have_qttestlib
-    qtHaveModule(positioning): WEBKIT_CONFIG += have_qtpositioning
-    qtHaveModule(sensors): WEBKIT_CONFIG += have_qtsensors
+    #qtHaveModule(positioning): WEBKIT_CONFIG += have_qtpositioning
+    #qtHaveModule(sensors): WEBKIT_CONFIG += have_qtsensors
 
-    config_libxml2: WEBKIT_CONFIG += use_libxml2
-    config_libxslt: WEBKIT_CONFIG += xslt
-    config_libzlib: WEBKIT_CONFIG += use_zlib
-    config_libwebp: WEBKIT_CONFIG += use_webp
-    config_leveldb: WEBKIT_CONFIG += use_system_leveldb
+    #config_libxml2: WEBKIT_CONFIG += use_libxml2
+    #config_libxslt: WEBKIT_CONFIG += xslt
+    #config_libzlib: WEBKIT_CONFIG += use_zlib
+    #config_libwebp: WEBKIT_CONFIG += use_webp
+    #config_leveldb: WEBKIT_CONFIG += use_system_leveldb
 
     # We can't use Qt's 3rdparty sources for libjpeg and libpng outside of qtbase, but if Qt
     # is using the system libraries, use them to take advantage of the WebCore image decoders as well.
@@ -109,9 +109,9 @@ defineTest(detectFeatures) {
         use?(gstreamer): WEBKIT_CONFIG += use_native_fullscreen_video
     }
 
-    !enable?(video):qtHaveModule(multimediawidgets) {
-        WEBKIT_CONFIG += video use_qt_multimedia
-    }
+    #!enable?(video):qtHaveModule(multimediawidgets) {
+    #    WEBKIT_CONFIG += video use_qt_multimedia
+    #}
 
     !enable?(video) {
         CONFIGURE_WARNINGS += "Missing GStreamer or QtMultimedia, disabling HTML5 media element support"
@@ -126,7 +126,7 @@ defineTest(detectFeatures) {
     }
 
     # Gamepad API Support (depends on udev and linux/joystick.h)
-    linux:!android: WEBKIT_CONFIG += gamepad
+    #linux:!android: WEBKIT_CONFIG += gamepad
 
     # Support for Graphics Surface
     # GraphicsSurface requires GraphicsContext3D and hence use_3d_graphics
diff --git a/qtwebkit/Tools/qmake/mkspecs/features/features.pri b/qtwebkit/Tools/qmake/mkspecs/features/features.pri
index ba18b354d4..dd27a421ca 100644
--- a/qtwebkit/Tools/qmake/mkspecs/features/features.pri
+++ b/qtwebkit/Tools/qmake/mkspecs/features/features.pri
@@ -59,7 +59,7 @@ FEATURE_DEFAULTS = \
     ENABLE_HIGH_DPI_CANVAS=0 \
     ENABLE_ICONDATABASE=1 \
     ENABLE_IFRAME_SEAMLESS=1 \
-    ENABLE_INDEXED_DATABASE=1 \
+    ENABLE_INDEXED_DATABASE=0 \
     ENABLE_INPUT_SPEECH=0 \
     ENABLE_INPUT_TYPE_COLOR=1 \
     ENABLE_INPUT_TYPE_DATE=0 \
