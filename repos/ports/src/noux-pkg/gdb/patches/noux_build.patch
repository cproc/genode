noux_build.patch

From: Christian Prochaska <christian.prochaska@genode-labs.com>


---
 gdb/configure             |   10 +++++-----
 gdb/dwarf-index-write.c   |    2 +-
 sim/common/Make-common.in |    2 +-
 3 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/gdb/configure b/gdb/configure
index b572d414..bb760f9c 100755
--- a/gdb/configure
+++ b/gdb/configure
@@ -6620,11 +6620,11 @@ fi
 # configuration.
 gdb_host_obs=posix-hdep.o
 
-if test "${target}" = "${host}"; then
-  gdb_native=yes
-else
+#if test "${target}" = "${host}"; then
+#  gdb_native=yes
+#else
   gdb_native=no
-fi
+#fi
 
 . $srcdir/configure.host
 
@@ -14369,7 +14369,7 @@ sigjmp_buf env; while (! sigsetjmp (env, 1)) siglongjmp (env, 1);
   return 0;
 }
 _ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
+if ac_fn_c_try_link "$LINENO"; then :
   gdb_cv_func_sigsetjmp=yes
 else
   gdb_cv_func_sigsetjmp=no
diff --git a/gdb/dwarf-index-write.c b/gdb/dwarf-index-write.c
index b176c1ef..3f4d2e8a 100644
--- a/gdb/dwarf-index-write.c
+++ b/gdb/dwarf-index-write.c
@@ -742,7 +742,7 @@ public:
     gdb_assert (m_abbrev_table.empty ());
     const size_t name_count = m_name_to_value_set.size ();
     m_bucket_table.resize
-      (std::pow (2, std::ceil (std::log2 (name_count * 4 / 3))));
+      (std::pow (2, std::ceil (log2 (name_count * 4 / 3))));
     m_hash_table.reserve (name_count);
     m_name_table_string_offs.reserve (name_count);
     m_name_table_entry_offs.reserve (name_count);
diff --git a/sim/common/Make-common.in b/sim/common/Make-common.in
index b254bf6c..5441cd82 100644
--- a/sim/common/Make-common.in
+++ b/sim/common/Make-common.in
@@ -236,7 +236,7 @@ CSEARCH = -I. -I$(srcdir) -I../common -I$(srccom) \
   -I../../bfd -I$(srcroot)/bfd \
   -I../../opcodes -I$(srcroot)/opcodes \
   @INCINTL@
-ALL_CFLAGS = $(CONFIG_CFLAGS) $(CSEARCH) $(CFLAGS)
+ALL_CFLAGS = $(CONFIG_CFLAGS) $(CSEARCH) $(CPPFLAGS) $(CFLAGS)
 BUILD_CFLAGS = -g -O $(CSEARCH)
 
 COMMON_DEP_CFLAGS = $(CONFIG_CFLAGS) $(CSEARCH)
