stdcxx_update.patch

From: Christian Prochaska <christian.prochaska@genode-labs.com>


---
 Makefile.tpl              |    1 +
 configure.ac              |    2 ++
 libstdc++-v3/acinclude.m4 |   16 ++++++++--------
 libstdc++-v3/configure.ac |    2 +-
 4 files changed, 12 insertions(+), 9 deletions(-)

diff --git a/Makefile.tpl b/Makefile.tpl
index a89f815..c326e87 100644
--- a/Makefile.tpl
+++ b/Makefile.tpl
@@ -506,6 +506,7 @@ COMPILER_AS_FOR_TARGET=@COMPILER_AS_FOR_TARGET@
 COMPILER_LD_FOR_TARGET=@COMPILER_LD_FOR_TARGET@
 COMPILER_NM_FOR_TARGET=@COMPILER_NM_FOR_TARGET@
 
+CPPFLAGS_FOR_TARGET = @CPPFLAGS_FOR_TARGET@
 CFLAGS_FOR_TARGET = @CFLAGS_FOR_TARGET@
 CXXFLAGS_FOR_TARGET = @CXXFLAGS_FOR_TARGET@
 
diff --git a/configure.ac b/configure.ac
index dbfaf4d..5a2d3a4 100644
--- a/configure.ac
+++ b/configure.ac
@@ -2380,6 +2380,8 @@ AC_ARG_WITH([debug-prefix-map],
   [DEBUG_PREFIX_CFLAGS_FOR_TARGET=])
 AC_SUBST(DEBUG_PREFIX_CFLAGS_FOR_TARGET)
 
+AC_SUBST(CPPFLAGS_FOR_TARGET)
+
 # During gcc bootstrap, if we use some random cc for stage1 then CFLAGS
 # might be empty or "-g".  We don't require a C++ compiler, so CXXFLAGS
 # might also be empty (or "-g", if a non-GCC C++ compiler is in the path).
diff --git a/libstdc++-v3/acinclude.m4 b/libstdc++-v3/acinclude.m4
index ce44a6a..2373dd5 100644
--- a/libstdc++-v3/acinclude.m4
+++ b/libstdc++-v3/acinclude.m4
@@ -1136,17 +1136,17 @@ AC_DEFUN([GLIBCXX_ENABLE_C99], [
     fi
 
     # Option parsed, now set things appropriately.
-    if test x"$glibcxx_cv_c99_math_cxx98" = x"no" ||
-       test x"$glibcxx_cv_c99_complex_cxx98" = x"no" ||
-       test x"$glibcxx_cv_c99_stdio_cxx98" = x"no" ||
-       test x"$glibcxx_cv_c99_stdlib_cxx98" = x"no" ||
-       test x"$glibcxx_cv_c99_wchar_cxx98" = x"no"; then
-      enable_c99=no;
-    else
+#    if test x"$glibcxx_cv_c99_math_cxx98" = x"no" ||
+#       test x"$glibcxx_cv_c99_complex_cxx98" = x"no" ||
+#       test x"$glibcxx_cv_c99_stdio_cxx98" = x"no" ||
+#       test x"$glibcxx_cv_c99_stdlib_cxx98" = x"no" ||
+#       test x"$glibcxx_cv_c99_wchar_cxx98" = x"no"; then
+#      enable_c99=no;
+#    else
       AC_DEFINE(_GLIBCXX_USE_C99, 1,
         [Define if C99 functions or macros from <wchar.h>, <math.h>,
         <complex.h>, <stdio.h>, and <stdlib.h> can be used or exposed.])
-    fi
+#    fi
 
     gcc_no_link="$ac_save_gcc_no_link"
     LIBS="$ac_save_LIBS"
diff --git a/libstdc++-v3/configure.ac b/libstdc++-v3/configure.ac
index 088f5e1..b8addaf 100644
--- a/libstdc++-v3/configure.ac
+++ b/libstdc++-v3/configure.ac
@@ -209,7 +209,7 @@ AC_CHECK_HEADERS(fenv.h complex.h)
 GLIBCXX_CHECK_C99_TR1
 
 # For the EOF, SEEK_CUR, and SEEK_END integer constants.
-#GLIBCXX_COMPUTE_STDIO_INTEGER_CONSTANTS
+GLIBCXX_COMPUTE_STDIO_INTEGER_CONSTANTS
 
 # For gettimeofday support.
 GLIBCXX_CHECK_GETTIMEOFDAY
