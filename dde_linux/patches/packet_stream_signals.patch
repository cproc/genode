packet_stream_signals.patch

From: Christian Prochaska <christian.prochaska@genode-labs.com>


---
 drivers/net/usb/usbnet.c |    6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/drivers/net/usb/usbnet.c b/drivers/net/usb/usbnet.c
index 1d60393..ad0e943 100644
--- a/drivers/net/usb/usbnet.c
+++ b/drivers/net/usb/usbnet.c
@@ -464,6 +464,8 @@ static int rx_submit (struct usbnet *dev, struct urb *urb, gfp_t flags)
 
 /*-------------------------------------------------------------------------*/
 
+extern void usb_drv_submit_packet_wakeup();
+
 static inline void rx_process (struct usbnet *dev, struct sk_buff *skb)
 {
 	if (dev->driver_info->rx_fixup &&
@@ -479,8 +481,10 @@ static inline void rx_process (struct usbnet *dev, struct sk_buff *skb)
 		/* all data was already cloned from skb inside the driver */
 		if (dev->driver_info->flags & FLAG_MULTI_PACKET)
 			dev_kfree_skb_any(skb);
-		else
+		else {
 			usbnet_skb_return(dev, skb);
+			usb_drv_submit_packet_wakeup();
+		}
 		return;
 	}
 
